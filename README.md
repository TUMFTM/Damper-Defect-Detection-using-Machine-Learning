# Damper-Defect-Detection-using-Machine-Learning

## Description

Evaluation of Machine Learning, Representation Learning and Deep Learning in the area of Supervised and Unsupervised Learning for the detection of defective suspension dampers.
These are different methods that estimate the state of the dampers from time signals of the vehicle dynamics (e.g. wheel speed, lateral and longitudinal acceleration and yaw rate). 
The different methods have different requirements. For example, labelled training data must be available for supervised learning approaches

## Short Description of Results
At first glance, all methods produce very similar results regarding the detection quality of defective dampers.
Deep learning approaches, however, are more robust with regard to changing boundary conditions of the measured data (e.g. additional mass in the trunk or winter instead of summer tires).

## Required Software
Shallow Machine Learning and Representation Learning methods are implemented in Matlab (2018b).
Deep Learning is implemented in Python.
Supervised Deep Learning (Convolutional Neural Networks) is implemented with Tensorflow Version 1.
Unsupervised Deep Learning (Variational Autoencoder) is implemented with Tensorflow 2.

## Purpose of the tool
The automated detection of defective chassis components is an important prerequisite for driving safety, especially when driving autonomously. The detection of a defective chassis is also desirable in other respects, as there is currently no such system in series production. Model-based methods do exist in science. However, they have never been used in reality. This raises doubts about the applicability and robustness of model-based methods. 

Machine learning methods become inherently robust if the training data covers all relevant aspects and boundary conditions. Since this will be given by the large amount of data generated in a vehicle fleet (especially in the future), machine learning methods were tested for their suitability to detect defective dampers.

The deposited methods are representatives from the fields of Shallow Machine Learning, Representation Learning and Deep Learning from the categories Supervised and Unsupervised Learning. 

## How to use the implemented methods
### Supervised Shallow Machine Learning
Feature-based classification with a SVM

Features:
- Hand generated (manual features)
- Data points of an FFT

Required software:
- Matlab (2018b)

Procedure for starting:
- Settings in Datenanalyse\Scripts\evaluateClassification.m
- ctrl.featureType = set 'manualFeatures' (or 'FFT')
- ctrl.classifierType = 'SVM
- run Datenanalyse\Scripts\evaluateClassification.m

### Unsupervised Shallow Machine Learning
Feature-based novelty detection with k-nearest neighbor algorithms

Features:
- Hand generated (manual features)
- Data points of an FFT

Required software:
- Matlab (2018b)
- Python (3.5 or higher)

Procedure for starting:
- Start Datenanalyse\Scripts\evaluateClassification.m in Matlab and save data
- Specify the path of the stored Matlab workspace in Datenanalyse\Scripts\evaluateNoveltyDetectionClassifier.py
- Start Datenanalyse\Scripts\evaluateNoveltyDetectionClassifier.py

### Supervised Representation Learning
Feature-based classification with a SVM

Features:
- Automatically generated by autoencoder
- Automatically generated by Sparsefilter

Required software:
- Matlab (2018b)

Procedure for starting:
- For Autoencoder: Check settings in Datenanalyse\Scripts\Autoencoder\setOptsAutoencoder.m
- For Sparsefilter: Check settings in Datenanalyse\Scripts\Sparsefilter\setOptsSparsefilter.m
- Check settings in Datenanalyse\Scripts\utilities/setOptions.m and adapt to your own case
- Settings in Datenanalyse\Scripts\evaluateClassification.m 
- Start Datenanalyse\Scripts\evaluateClassification.m

### Unsupervised Representation Learning
Feature-based novelty detection with k-nearest neighbor algorithms

Features:
- Automatically generated by autoencoder
- Automatically generated by Sparsefilter

Required software:
- Matlab (2018b)
- Python (3.5 or higher)

Procedure for starting:
- Start Datenanalyse\Scripts\evaluateClassification.m in Matlab and save data
- Specify the path of the stored Matlab workspace in Datenanalyse\Scripts\evaluateNoveltyDetectionClassifier.py
- Start Datenanalyse\Scripts\evaluateNoveltyDetectionClassifier.py


### Supervised Deep Learning
Classification of time signals using Convolutional Neural Networks (CNN)
- Preprocessing of the time signals by Detrend, FFT or 
Short-Time-Fourier-Transformation (STFT)
- Classification by (CNN)

Required software:
- Python (3.5 or higher)

Procedure for starting:
- Export data from Matlab as CSV. 
- Start Datenanalyse\Scripts\evaluateClassification.m with desired options
- Datenanalyse\scripts\utilities\exportDataToCsv.m with variable "dataFull" (call in Matlab "exportDataToCsv(dataFull, opts)")
- Check and adjust options in Datenanalyse\Scripts\CNN\mainArchVar.py (options can also be passed via command line
- Start Datenanalyse\Scripts\CNN\mainArchVar.py

### Unsupervised Deep Learning
Novelty Detection using Probability-based Variational Autoencoder (VAE)
- Preprocessing of the data by means of FFT

Required software:
- Python (3.6 or higher)

Procedure for starting:
- Export data from Matlab as CSV. 
- Start Datenanalyse\Scripts\evaluateClassification.m with desired options
- Datenanalyse\scripts\utilities\exportDataToCsv.m with variable "dataFull" (call in Matlab "exportDataToCsv(dataFull, opts)")
- Check and adjust options in Datenanalyse\Scripts\NoveltyDetection\Autoencoder\config.args
- Start Datenanalyse\Scripts\NoveltyDetection\Autoencoder\main.py
